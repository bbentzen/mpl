/-
Copyright (c) 2017 Bruno Bentzen. All rights reserved.
Released under the Apache License 2.0 (see "License");
Author: Bruno Bentzen
-/

import .default

open classical

variable (Ïƒ : nat)

/- Kripke models -/

structure model := (wrlds : list (ctx Ïƒ)) (access : ctx Ïƒ â†’ ctx Ïƒ â†’ bool) (val : var Ïƒ â†’ ctx Ïƒ â†’ bool)

notation `ğ“¦` `â¸´` `ğ“¡` `â¸´` `ğ“¿` := model

notation `ğ“¦` `â–¹` M := M.wrlds
notation `ğ“¡` `â–¹` M := M.access
notation `ğ“¿` `â–¹` M := M.val

local attribute [instance] prop_decidable

noncomputable def form_tt_in_wrld (M : (ğ“¦ â¸´ ğ“¡ â¸´ ğ“¿) Ïƒ) : form Ïƒ â†’ ctx Ïƒ â†’ bool
|  (#p)   := Î» w, (ğ“¿ â–¹ M) p w
|   âŠ¥     := Î» w, ff 
| (p âŠƒ q) := Î» w, (bnot (form_tt_in_wrld p w)) || (form_tt_in_wrld q w) 
|  (â—»p)   := Î» w,
  if (âˆ€ v, w âˆˆ (ğ“¦ â–¹ M) â†’ v âˆˆ (ğ“¦ â–¹ M) â†’ (ğ“¡ â–¹ M) w v = tt â†’ form_tt_in_wrld p v = tt) then tt else ff

/- Satisfiability -/

notation M `â¦ƒ` p `â¦„` w := form_tt_in_wrld _ M p w
inductive stsf (M : (ğ“¦ â¸´ ğ“¡ â¸´ ğ“¿) Ïƒ) (p : form Ïƒ) : Prop 
| is_true (m : Î  w, (M â¦ƒpâ¦„ w) = tt) : stsf
notation M `âŠ¨â‚–` p := stsf _ M p

/- Validity -/

noncomputable def ctx_tt_in_wrld (M : (ğ“¦ â¸´ ğ“¡ â¸´ ğ“¿) Ïƒ) : ctx Ïƒ â†’ ctx Ïƒ â†’ bool
| Â·      := Î» w, tt
| (Î“ â¸´ p) := Î» w, ctx_tt_in_wrld Î“ w && form_tt_in_wrld _ M p w

notation M `â¦ƒ` Î“ `â¦„` w := ctx_tt_in_wrld _ M Î“ w

inductive sem_csq (Î“ : ctx Ïƒ) (p : form Ïƒ) : Prop
| is_true (m : Î  (M : (ğ“¦ â¸´ ğ“¡ â¸´ ğ“¿) Ïƒ) w, (M â¦ƒÎ“â¦„ w) = tt â†’ (M â¦ƒpâ¦„ w) = tt) : sem_csq

notation Î“ `âŠ¨â‚–` p := sem_csq _ Î“ p
